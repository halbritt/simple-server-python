pipeline:
- dataplugins:
  - type: pollingplugin
    name: 'File Transport Plugin'
    version: 1.0.0
    config:
      logname: 'Client File Service'
      host: localhost
      completed_folder: '/var/spool/sightmachine/factorytx/completed/client_wafer'
      # Todo: for localfile
      remove_remote_completed: false
      poll_rate: 10
      datasources:
        - name: CLIENT_SiliconProbingV2_1
          type: filepolling
          config:
            version: 1.0.0
            protocol: localfile
            max_resource_size: 100
            root_path: '/var/data/sample_data/WAFER'
      parsers:
        - type: spreadsheetparser
          config:
            version: 1.0.0
            sheet_type: csv
            parse_options:
              - report_pattern: '*.TXT'
                load:
                  parse:
                    error_bad_lines: false
                    warn_bad_lines: true
                    dayfirst: true
                    parse_timestamps: {"SiP_Date": "%d-%m-%Y"}
                    sep: ","
            datasources: [CLIENT_SiliconProbingV2_1]
- transforms:
  - type: sslogtransform
    name: Client Transform
    config:
      datasources:
        - name: CLIENT_SiliconProbingV2_1
      version: 1.0.0
      poll_rate: 1
      counter: True
      actions:
        - rename:
            columns:
              "SiP_WaferID": batch_no
        - set_index: ['SiP_Date']
      stractions:
        - column: SiP_PartType
          function: strip
        - column: batch_no
          function: strip
        - column: SiP_WaferNo
          function: strip
        - column: SiP_PartNo
          function: strip
  - type: sslogtransform
    name: Mod Transform
    config:
      version: 1.0.0
      datasources:
        - name: CLIENT_ModuleATE_1
      actions:
        - set_index: ['0']
- tx:
  - type: remotedatapost
    name: remote data post
    version: 1.0.0
    config:
      datasources:
        - name: CLIENT_SiliconProbingV2_1
      version: 1.0.0
      output_name: 'cs-mrslim-dev'  # XXX
      apikey: 'JDYkcm91bmRzPTEwMDAwMCRNNlZBaG9yZ3BPVVYuQ0lGJFVxdnY0cnpuT2hwQUV5Qk9WUHpxNC5hRTYxckIzWlFXbTBRekovM3AwNER5Q2QwQ3lSbmk4ajV4bUx3eXJmbGwwdy4wcGNDUm8xWHlVSDBSQnl0c1Iw'
      tenantname: cs  # XXX
      apikeyid: 'rdpv2@cs.sightmachine.com'
      sitedomain: 'mrslim-dev'
      protocol: 'http'
      username: ''
      password: ''
      use_encryption: True
